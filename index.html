<!DOCTYPE html>
<html lang="zh-CN" class="full">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¥ç¨‹ç®¡ç† - æ‹‰æ™®è¾¾</title>
    <meta name="description" content="å››è±¡é™å¾…åŠäº‹é¡¹ç®¡ç†é¡µé¢ã€‚">
    <meta name="theme-color" content="plum">
    <link rel="stylesheet" href="css/index.css">
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <header>
        <div class="title">æ—¥ç¨‹ç®¡ç†</div>
        <div class="controls">
            <input type="text" placeholder="ğŸ” æœç´¢..." id="search-all" class="search-input">
            <div id="user-info" style="display: none;">
                <span class="username"></span>
                <button id="logout-btn">ç™»å‡º</button>
            </div>
            <button id="login-btn">ç™»å½•</button>
        </div>
    </header>

    <div class="schedule-main-container">
        <!-- å·¦ä¾§ï¼šå†å²è®°å½•ç›®å½• -->
        <div class="history-sidebar">
            <div class="history-header">
                <h3>ğŸ“š å†å²è®°å½•</h3>
                <button id="toggle-history" class="toggle-btn">æ”¶èµ·</button>
            </div>
            <div class="history-list" id="history-list">
                <div class="history-loading">åŠ è½½ä¸­...</div>
            </div>
        </div>

        <!-- å³ä¾§ï¼šå››è±¡é™å¾…åŠåˆ—è¡¨ -->
        <div class="quadrant-container">
            <!-- æ·»åŠ å¾…åŠè¡¨å• -->
            <div class="add-todo-form">
                <input type="text" placeholder="ğŸ“ æ·»åŠ å¾…åŠäº‹é¡¹..." id="todo-input" class="todo-input">
                <div class="todo-form-options">
                    <div class="option-group">
                        <label>é‡è¦æ€§ï¼š</label>
                        <select id="importance">
                            <option value="high">é‡è¦</option>
                            <option value="low">ä¸é‡è¦</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label>ç´§æ€¥åº¦ï¼š</label>
                        <select id="urgency">
                            <option value="high">ç´§æ€¥</option>
                            <option value="low">ä¸ç´§æ€¥</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label>æˆªæ­¢æ—¥æœŸï¼š</label>
                        <input type="date" id="deadline">
                    </div>
                    <button id="add-todo-btn" class="btn-add">æ·»åŠ </button>
                </div>
            </div>

            <!-- å››è±¡é™ç½‘æ ¼ -->
            <div class="quadrant-grid">
                <!-- ç¬¬ä¸€è±¡é™ï¼šé‡è¦ä¸”ç´§æ€¥ -->
                <div class="quadrant quadrant-1">
                    <div class="quadrant-header">
                        <h3>ğŸ”¥ é‡è¦ä¸”ç´§æ€¥</h3>
                        <span class="quadrant-count" id="q1-count">0</span>
                    </div>
                    <div class="quadrant-content" id="quadrant-1">
                        <div class="empty-quadrant">æš‚æ— ä»»åŠ¡</div>
                    </div>
                </div>

                <!-- ç¬¬äºŒè±¡é™ï¼šé‡è¦ä½†ä¸ç´§æ€¥ -->
                <div class="quadrant quadrant-2">
                    <div class="quadrant-header">
                        <h3>â­ é‡è¦ä½†ä¸ç´§æ€¥</h3>
                        <span class="quadrant-count" id="q2-count">0</span>
                    </div>
                    <div class="quadrant-content" id="quadrant-2">
                        <div class="empty-quadrant">æš‚æ— ä»»åŠ¡</div>
                    </div>
                </div>

                <!-- ç¬¬ä¸‰è±¡é™ï¼šç´§æ€¥ä½†ä¸é‡è¦ -->
                <div class="quadrant quadrant-3">
                    <div class="quadrant-header">
                        <h3>âš¡ ç´§æ€¥ä½†ä¸é‡è¦</h3>
                        <span class="quadrant-count" id="q3-count">0</span>
                    </div>
                    <div class="quadrant-content" id="quadrant-3">
                        <div class="empty-quadrant">æš‚æ— ä»»åŠ¡</div>
                    </div>
                </div>

                <!-- ç¬¬å››è±¡é™ï¼šä¸é‡è¦ä¹Ÿä¸ç´§æ€¥ -->
                <div class="quadrant quadrant-4">
                    <div class="quadrant-header">
                        <h3>ğŸ“Œ ä¸é‡è¦ä¹Ÿä¸ç´§æ€¥</h3>
                        <span class="quadrant-count" id="q4-count">0</span>
                    </div>
                    <div class="quadrant-content" id="quadrant-4">
                        <div class="empty-quadrant">æš‚æ— ä»»åŠ¡</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <ul class="nav">
        <li><a href="diary.html">æ—¥è®°</a></li>
        <li><a href="blog.html">åšå®¢</a></li>
        <li><a href="index.html">æ—¥ç¨‹</a></li>
    </ul>

    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.3.0/jquery.min.js"></script>
    <script src="//code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script>
        // åˆå§‹åŒ– LeanCloudï¼ˆå¿…é¡»åœ¨ auth.js ä¹‹å‰ï¼‰
        AV.init({
            appId: "szRqJxj4rGr47DBsfiYqh9qA-gzGzoHsz",
            appKey: "UCGehmC6gOKYHSKpoMLeaRFJ",
            serverURL: "https://szrqjxj4.lc-cn-n1-shared.com"
        });
    </script>
    <script src="js/auth.js"></script>
    <script src="js/login-modal.js"></script>
    <script src="js/todolist.js"></script>
    <script>
        // åˆå§‹åŒ–ç™»å½•æŒ‰é’®
        document.querySelector('#login-btn')?.addEventListener('click', showLoginModal);
        document.querySelector('#logout-btn')?.addEventListener('click', async () => {
            await logout();
        });
        
        // æ£€æŸ¥ç¼–è¾‘æƒé™
        function requireLogin() {
            if (!canEdit()) {
                alert('è¯·å…ˆç™»å½•æ‰èƒ½è¿›è¡Œç¼–è¾‘æ“ä½œ');
                showLoginModal();
                return false;
            }
            return true;
        }

        // å†å²è®°å½•ä¾§è¾¹æ åˆ‡æ¢
        document.querySelector('#toggle-history')?.addEventListener('click', function() {
            const sidebar = document.querySelector('.history-sidebar');
            const isCollapsed = sidebar.classList.contains('collapsed');
            if (isCollapsed) {
                sidebar.classList.remove('collapsed');
                this.textContent = 'æ”¶èµ·';
            } else {
                sidebar.classList.add('collapsed');
                this.textContent = 'å±•å¼€';
            }
        });
    </script>
</body>

</html>
